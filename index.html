<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Capsule Ferrofluid Study</title>
    <link rel="stylesheet" href="./styles.css" />
    <script type="module" src="./main.js"></script>
  </head>
  <body>
    <canvas id="scene" aria-label="ferrofluid simulation"></canvas>

    <section class="hud hud-left" aria-label="simulation and audio controls">
      <h1>Capsule Ferrofluid</h1>
      <p>Driver-based ferrofluid motion and real-time audio control.</p>

      <div class="hud-section" data-collapsible>
        <button class="hud-section-toggle" type="button" aria-expanded="true">
          <span class="hud-group-title">Fluid Dynamics</span>
          <span class="hud-section-chevron" aria-hidden="true"></span>
        </button>

        <label for="magnetStrength">Magnet strength</label>
        <div class="control-row">
          <input id="magnetStrength" type="range" min="0" max="500" step="1" value="500" />
          <output id="magnetStrength-value">500</output>
        </div>

        <label for="magnetSize">Magnet size</label>
        <div class="control-row">
          <input id="magnetSize" type="range" min="0.35" max="5.0" step="0.01" value="1.00" />
          <output id="magnetSize-value">1.00</output>
        </div>

        <label for="gravity">Gravity</label>
        <div class="control-row">
          <input id="gravity" type="range" min="0" max="180" step="1" value="52" />
          <output id="gravity-value">52</output>
        </div>

        <label for="jitter">Organic jitter</label>
        <div class="control-row">
          <input id="jitter" type="range" min="0" max="45" step="1" value="45" />
          <output id="jitter-value">45</output>
        </div>

        <label for="density">Density</label>
        <div class="control-row">
          <input id="density" type="range" min="0.5" max="2.2" step="0.01" value="0.78" />
          <output id="density-value">0.78</output>
        </div>

        <label for="viscosity">Viscosity</label>
        <div class="control-row">
          <input id="viscosity" type="range" min="0" max="0.6" step="0.001" value="0.050" />
          <output id="viscosity-value">0.050</output>
        </div>

        <label for="resistance">Resistance</label>
        <div class="control-row">
          <input id="resistance" type="range" min="0" max="1.2" step="0.01" value="0.94" />
          <output id="resistance-value">0.94</output>
        </div>

        <label for="surfaceTension">Surface tension</label>
        <div class="control-row">
          <input id="surfaceTension" type="range" min="0" max="2.5" step="0.01" value="2.50" />
          <output id="surfaceTension-value">2.50</output>
        </div>
      </div>

      <div class="hud-section" data-collapsible>
        <button class="hud-section-toggle" type="button" aria-expanded="true">
          <span class="hud-group-title">Drive</span>
          <span class="hud-section-chevron" aria-hidden="true"></span>
        </button>

        <label for="pulseHz">Pulse rate (Hz)</label>
        <div class="control-row">
          <input id="pulseHz" type="range" min="0.5" max="18" step="0.1" value="8.4" />
          <output id="pulseHz-value">8.4</output>
        </div>

        <label for="pulseAggression">Pulse aggression</label>
        <div class="control-row">
          <input id="pulseAggression" type="range" min="0" max="14" step="0.1" value="7.2" />
          <output id="pulseAggression-value">7.2</output>
        </div>

        <label class="checkbox-row" for="manualPulse">
          <input id="manualPulse" type="checkbox" checked />
          <span>Manual pulse mode (mouse)</span>
        </label>

        <label class="checkbox-row" for="audioReactive">
          <input id="audioReactive" type="checkbox" />
          <span>Audio reactive drive</span>
        </label>

        <label for="driveMode">Driver behavior</label>
        <div class="control-row">
          <select id="driveMode">
            <option value="gate">Magnet on/off</option>
            <option value="inout" selected>Magnet in/out</option>
          </select>
        </div>
      </div>

      <div class="hud-section" data-collapsible>
        <button class="hud-section-toggle" type="button" aria-expanded="true">
          <span class="hud-group-title">Audio Input</span>
          <span class="hud-section-chevron" aria-hidden="true"></span>
        </button>

        <label for="audioFile">Music file</label>
        <div class="control-row">
          <input id="audioFile" type="file" accept="audio/*" />
        </div>

        <div class="button-row">
          <button id="audioToggle" type="button">Play file</button>
          <button id="micToggle" type="button">Use mic</button>
          <button id="systemToggle" type="button">Use system</button>
        </div>

        <label for="audioSensitivity">Audio sensitivity</label>
        <div class="control-row">
          <input id="audioSensitivity" type="range" min="0.4" max="8.0" step="0.01" value="1.37" />
          <output id="audioSensitivity-value">1.37</output>
        </div>

        <label for="audioSmoothing">Audio smoothing</label>
        <div class="control-row">
          <input id="audioSmoothing" type="range" min="0" max="0.98" step="0.01" value="0.72" />
          <output id="audioSmoothing-value">0.72</output>
        </div>

        <label for="audioThreshold">Audio threshold</label>
        <div class="control-row">
          <input id="audioThreshold" type="range" min="0" max="0.7" step="0.01" value="0.51" />
          <output id="audioThreshold-value">0.51</output>
        </div>

        <p class="audio-status" id="audioStatus">Audio source: none</p>
      </div>
    </section>

    <section class="hud hud-right" aria-label="render and lighting controls">
      <div class="hud-section" data-collapsible>
        <button class="hud-section-toggle" type="button" aria-expanded="true">
          <span class="hud-group-title">Render</span>
          <span class="hud-section-chevron" aria-hidden="true"></span>
        </button>

        <label for="renderQuality">Render quality</label>
        <div class="control-row">
          <input id="renderQuality" type="range" min="0.6" max="2.4" step="0.05" value="1.00" />
          <output id="renderQuality-value">1.00</output>
        </div>

        <label for="cameraOffsetX">Camera offset X</label>
        <div class="control-row">
          <input id="cameraOffsetX" type="range" min="-0.35" max="0.35" step="0.01" value="0.08" />
          <output id="cameraOffsetX-value">0.08</output>
        </div>

        <label for="cameraYaw">Camera yaw (deg)</label>
        <div class="control-row">
          <input id="cameraYaw" type="range" min="-24" max="24" step="0.1" value="10.0" />
          <output id="cameraYaw-value">10.0</output>
        </div>

        <label for="cameraOffsetY">Camera offset Y</label>
        <div class="control-row">
          <input id="cameraOffsetY" type="range" min="-0.35" max="0.35" step="0.01" value="-0.04" />
          <output id="cameraOffsetY-value">-0.04</output>
        </div>

        <label class="checkbox-row" for="enableOrbitDrag">
          <input id="enableOrbitDrag" type="checkbox" checked />
          <span>Enable orbit drag</span>
        </label>
        <p class="audio-status">Right-drag (or Alt/Shift + drag) to orbit.</p>
        <div class="button-row button-row-single">
          <button id="resetOrbitView" type="button">Reset orbit</button>
        </div>

        <label for="fluidColor">Fluid color</label>
        <div class="control-row">
          <input id="fluidColor" type="color" value="#0062ff" />
          <output id="fluidColor-value">#0062ff</output>
        </div>

        <label for="fluidTint">Fluid tint</label>
        <div class="control-row">
          <input id="fluidTint" type="range" min="0" max="1" step="0.01" value="0.81" />
          <output id="fluidTint-value">0.81</output>
        </div>

        <label class="checkbox-row" for="showSpeaker">
          <input id="showSpeaker" type="checkbox" />
          <span>Show speaker</span>
        </label>

        <label class="checkbox-row" for="viewMagnet">
          <input id="viewMagnet" type="checkbox" />
          <span>View magnet</span>
        </label>
      </div>

      <div class="hud-section" data-collapsible>
        <button class="hud-section-toggle" type="button" aria-expanded="true">
          <span class="hud-group-title">Material</span>
          <span class="hud-section-chevron" aria-hidden="true"></span>
        </button>

        <label for="reflectivity">Reflectivity</label>
        <div class="control-row">
          <input id="reflectivity" type="range" min="0" max="2.2" step="0.01" value="0.52" />
          <output id="reflectivity-value">0.52</output>
        </div>

        <label for="impactHighlights">Impact highlights</label>
        <div class="control-row">
          <input id="impactHighlights" type="range" min="0" max="2.5" step="0.01" value="1.15" />
          <output id="impactHighlights-value">1.15</output>
        </div>

        <label for="flakeAmount">Granular finish</label>
        <div class="control-row">
          <input id="flakeAmount" type="range" min="0" max="1" step="0.01" value="0.18" />
          <output id="flakeAmount-value">0.18</output>
        </div>

        <label for="iridescenceStrength">Oil-slick intensity</label>
        <div class="control-row">
          <input id="iridescenceStrength" type="range" min="0" max="2.4" step="0.01" value="0.00" />
          <output id="iridescenceStrength-value">0.00</output>
        </div>
      </div>

      <div class="hud-section" data-collapsible>
        <button class="hud-section-toggle" type="button" aria-expanded="true">
          <span class="hud-group-title">LED Ring</span>
          <span class="hud-section-chevron" aria-hidden="true"></span>
        </button>

        <p class="audio-status" id="hdriStatus">HDRI: loading...</p>

        <label class="checkbox-row" for="useHdriReflections">
          <input id="useHdriReflections" type="checkbox" checked />
          <span>Use HDR reflections</span>
        </label>

        <label for="pointLightColor">LED color</label>
        <div class="control-row">
          <input id="pointLightColor" type="color" value="#ff0000" />
          <output id="pointLightColor-value">#ff0000</output>
        </div>

        <label for="pointLightIntensity">LED intensity</label>
        <div class="control-row">
          <input id="pointLightIntensity" type="range" min="0" max="2.2" step="0.01" value="1.00" />
          <output id="pointLightIntensity-value">1.00</output>
        </div>

        <label for="sideLightStrength">Side illumination</label>
        <div class="control-row">
          <input id="sideLightStrength" type="range" min="0" max="2.5" step="0.01" value="1.00" />
          <output id="sideLightStrength-value">1.00</output>
        </div>

        <label for="envLightStrength">HDRI response</label>
        <div class="control-row">
          <input id="envLightStrength" type="range" min="0" max="2.5" step="0.01" value="1.20" />
          <output id="envLightStrength-value">1.20</output>
        </div>

        <label for="exposure">Exposure</label>
        <div class="control-row">
          <input id="exposure" type="range" min="0.6" max="1.8" step="0.01" value="1.06" />
          <output id="exposure-value">1.06</output>
        </div>

        <label for="pointLightOffsetX">LED bias X</label>
        <div class="control-row">
          <input id="pointLightOffsetX" type="range" min="-1" max="1" step="0.01" value="-0.25" />
          <output id="pointLightOffsetX-value">-0.25</output>
        </div>

        <label for="pointLightOffsetY">LED bias Y</label>
        <div class="control-row">
          <input id="pointLightOffsetY" type="range" min="-1" max="1" step="0.01" value="-0.47" />
          <output id="pointLightOffsetY-value">-0.47</output>
        </div>
      </div>
    </section>
  </body>
</html>
